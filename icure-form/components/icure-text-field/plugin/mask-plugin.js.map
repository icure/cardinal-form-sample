{"version":3,"file":"mask-plugin.js","sourceRoot":"","sources":["../../../../tmp/components/icure-text-field/plugin/mask-plugin.ts"],"names":[],"mappings":";;;AAAA,yDAAmF;AAEnF,uDAAwE;AAEjE,MAAM,UAAU,GAAG;IACzB,MAAM,QAAQ,GAAG,CAAC,IAAiB,EAAE,IAAY,EAAE,IAAY,EAAE,EAAe,EAAE,YAAY,GAAG,IAAI,EAAE,EAAE;QACxG,MAAM,iBAAiB,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,GAAG,IAAI,CAAA;QAC9E,MAAM,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;QAEzF,IAAI,CAAC,GAAG,iBAAiB,CAAA;QACzB,IAAI,IAAI,GAAG,CAAC,CAAA;QACZ,IAAI,SAAS,GAAG,KAAK,CAAA;QAErB,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;YACpB,CAAC,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAA;YAC/C,SAAS,GAAG,IAAI,CAAA;QACjB,CAAC;QAED,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,CAAC;YACtD,IACC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG;gBACf,CAAC,CAAC,CAAC,CAAC;qBACF,SAAS,CAAC,KAAK,CAAC;qBAChB,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC;qBAC/B,KAAK,CAAC,MAAM,CAAC,CAAC;gBACjB,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,EACpC,CAAC;gBACF,MAAM;YACP,CAAC;iBAAM,CAAC;gBACP,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;oBACtB,MAAM;gBACP,CAAC;qBAAM,CAAC;oBACP,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAA;oBAChD,IAAI,CAAC,SAAS;wBAAE,IAAI,EAAE,CAAA;gBACvB,CAAC;YACF,CAAC;YACD,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC;gBACtC,CAAC,IAAI,YAAY,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAA;gBAC/C,SAAS,GAAG,IAAI,CAAA;YACjB,CAAC;QACF,CAAC;QAED,MAAM,IAAI,GAAG,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA;QACnE,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,CAAA;QAE/B,MAAM,KAAK,GAAG,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAA;QACpE,IAAI,CAAC,KAAK,iBAAiB,IAAI,KAAK,KAAK,YAAY,EAAE,CAAC;YACvD,OAAO,SAAS,CAAA;QACjB,CAAC;QAED,MAAM,UAAU,GAAG,EAAE,CAAC,SAAS,CAAA;QAE/B,EAAE,GAAG,EAAE,CAAC,UAAU,CAAC,CAAC,GAAG,KAAK,EAAE,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;QACpH,IAAI,YAAY,EAAE,CAAC;YAClB,EAAE,GAAG,EAAE,CAAC,YAAY,CAAC,iCAAa,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;QACrH,CAAC;aAAM,CAAC;YACP,EAAE,GAAG,EAAE,CAAC,YAAY,CAAC,iCAAa,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAA;QACvK,CAAC;QACD,EAAE,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,CAAA;QAE5B,OAAO,EAAE,CAAA;IACV,CAAC,CAAA;IAED,SAAS,aAAa,CAAC,KAAkB;QACxC,IAAI,EAAE,GAAG,SAAS,CAAA;QAClB,IAAI,OAAO,GAAG,CAAC,CAAA;QACf,qCAAqC;QACrC,OAAO,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,GAAG,IAAI,OAAO,GAAG,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;YACtE,MAAM,IAAI,GAAG,CAAC,EAAE,IAAI,KAAK,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;YAC/C,MAAM,IAAI,GAAqB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,SAAS,CAAA;YACjE,MAAM,IAAI,GAAuB,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,IAAI,CAAC,IAAI,CAAC,IAAI,CAAA;YACrD,IAAI,IAAI,EAAE,CAAC;gBACV,EAAE,GAAG,EAAE,IAAI,KAAK,CAAC,EAAE,CAAA;gBACnB,EAAE,GAAG,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,KAAK,CAAC,IAAI,EAAE,CAAA;gBACjE,MAAM,OAAO,GAAG,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;gBACvC,MAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAA;gBAC3C,IAAI,OAAO,EAAE,CAAC;oBACb,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,CAAA;gBACpC,CAAC;;oBAAM,OAAO,EAAE,CAAA;YACjB,CAAC;iBAAM,CAAC;gBACP,OAAO,EAAE,CAAA;YACV,CAAC;QACF,CAAC;QACD,OAAO,EAAE,CAAA;IACV,CAAC;IAED,OAAO,IAAI,0BAAM,CAAC;QACjB,IAAI,EAAE,CAAC,CAAa,EAAE,EAAE;YACvB,MAAM,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,CAAA;YACjC,IAAI,EAAE;gBAAE,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAA;YACxC,OAAO,EAAE,CAAA;QACV,CAAC;QACD,KAAK,EAAE;YACN,WAAW,CAAC,KAAK;gBAChB,IAAI,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAA;gBACzF,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAA;gBACtB,IAAI,KAAK,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,CAAA;gBAExC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;oBACzB,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,YAAY,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;wBAC1G,sBAAsB;wBACtB,OAAO,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC;4BAC9C,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAA;4BACtC,IAAI,GAAG,IAAI,CAAC,MAAM,CAAA;4BAElB,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;gCACjC,KAAK,GAAG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,CAAA;gCACpC,MAAK;4BACN,CAAC;wBACF,CAAC;oBACF,CAAC;oBAED,OAAO,gCAAa,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,6BAAU,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC,CAAA;gBACtH,CAAC;gBACD,OAAO,SAAS,CAAA;YACjB,CAAC;YACD,eAAe,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE;gBACzC,IAAI,IAAI,CAAC,SAAS;oBAAE,OAAO,KAAK,CAAA;gBAEhC,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAA;gBACxB,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;gBACrC,MAAM,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAA;gBACxC,MAAM,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAA;gBAE5C,IAAI,CAAC,IAAI;oBAAE,OAAO,KAAK,CAAA;gBAEvB,MAAM,EAAE,GAAG,QAAQ,CAClB,KAAK,EACL,MAAM,IAAI,MAAM,CAAC,MAAM;oBACtB,CAAC,CAAC,IAAI;yBACH,KAAK,CAAC,EAAE,CAAC;yBACT,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;yBAC1C,IAAI,CAAC,EAAE,CAAC;oBACX,CAAC,CAAC,IAAI,EACP,IAAI,EACJ,KAAK,CAAC,EAAE,CACR,CAAA;gBACD,IAAI,EAAE,EAAE,CAAC;oBACR,MAAM,IAAI,GAAW,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,CAAA;oBAC3C,IAAI,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,MAAM,EAAE,CAAC;wBAClB,MAAM,OAAO,GAAG,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,GAAG,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAA;wBACjH,IAAI,OAAO,EAAE,CAAC;4BACb,MAAM,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAA;4BAC5C,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC;gCAC3E,QAAQ,CAAC,OAAO,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CAAA;4BACrD,CAAC;iCAAM,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC;gCAC5E,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAA;4BAC9C,CAAC;wBACF,CAAC;oBACF,CAAC;oBACD,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAA;oBACjB,OAAO,IAAI,CAAA;gBACZ,CAAC;gBACD,OAAO,KAAK,CAAA;YACb,CAAC;SACD;QACD,iBAAiB,EAAE,CAAC,YAAoC,EAAE,QAAqB,EAAE,QAAqB,EAAE,EAAE;YACzG,OAAO,aAAa,CAAC,QAAQ,CAAC,CAAA;QAC/B,CAAC;KACD,CAAC,CAAA;AACH,CAAC,CAAA;AA5JY,QAAA,UAAU,cA4JtB","sourcesContent":["import { EditorState, Plugin, TextSelection, Transaction } from 'prosemirror-state'\nimport { Node, ResolvedPos } from 'prosemirror-model'\nimport { Decoration, DecorationSet, EditorView } from 'prosemirror-view'\n\nexport const maskPlugin = function (): Plugin {\n\tconst maskText = ($pos: ResolvedPos, text: string, mask: string, tr: Transaction, setSelection = true) => {\n\t\tconst textFromBeginning = $pos.parent.textBetween(0, $pos.parentOffset) + text\n\t\tconst trailingText = $pos.parent.textBetween($pos.parentOffset, $pos.parent.content.size)\n\n\t\tlet t = textFromBeginning\n\t\tlet skip = 0\n\t\tlet completed = false\n\n\t\tif (t.length === 0) {\n\t\t\tt += trailingText.substring(text.length + skip)\n\t\t\tcompleted = true\n\t\t}\n\n\t\tfor (let i = 0; i < mask.length && i < t.length; i++) {\n\t\t\tif (\n\t\t\t\t(mask[i] === '.' &&\n\t\t\t\t\tt[i]\n\t\t\t\t\t\t.normalize('NFD')\n\t\t\t\t\t\t.replace(/[\\u0300-\\u036f]/g, '')\n\t\t\t\t\t\t.match(/\\w|-/)) ||\n\t\t\t\t(mask[i] === '-' && t[i].match(/\\d/))\n\t\t\t) {\n\t\t\t\t//skip\n\t\t\t} else {\n\t\t\t\tif (mask[i] === t[i]) {\n\t\t\t\t\t//skip\n\t\t\t\t} else {\n\t\t\t\t\tt = t.substring(0, i) + mask[i] + t.substring(i)\n\t\t\t\t\tif (!completed) skip++\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (t.length === i + 1 && !completed) {\n\t\t\t\tt += trailingText.substring(text.length + skip)\n\t\t\t\tcompleted = true\n\t\t\t}\n\t\t}\n\n\t\tconst tail = t.length > mask.length ? t.substring(mask.length) : ''\n\t\tt = t.substring(0, mask.length)\n\n\t\tconst trail = t.length < mask.length ? mask.substring(t.length) : ''\n\t\tif (t === textFromBeginning && trail === trailingText) {\n\t\t\treturn undefined\n\t\t}\n\n\t\tconst currentSel = tr.selection\n\n\t\ttr = tr.insertText(t + trail, $pos.pos - $pos.parentOffset, $pos.pos - $pos.parentOffset + $pos.parent.content.size)\n\t\tif (setSelection) {\n\t\t\ttr = tr.setSelection(TextSelection.create(tr.doc, Math.min($pos.pos + text.length + skip, tr.doc.content.size - 1)))\n\t\t} else {\n\t\t\ttr = tr.setSelection(TextSelection.create(tr.doc, Math.min(currentSel.$anchor.pos, tr.doc.content.size - 1), Math.min(currentSel.$head.pos, tr.doc.content.size - 1)))\n\t\t}\n\t\ttr.setMeta('tailText', tail)\n\n\t\treturn tr\n\t}\n\n\tfunction applyDocMasks(state: EditorState): Transaction | undefined {\n\t\tlet tr = undefined\n\t\tlet posMark = 0\n\t\t//Scan nodes and add mask when needed\n\t\twhile ((tr || state).doc && posMark < (tr || state).doc.content.size) {\n\t\t\tconst $pos = (tr || state).doc.resolve(posMark)\n\t\t\tconst node: Node | undefined = $pos.node($pos.depth) || undefined\n\t\t\tconst mask: string | undefined = node?.type.spec.mask\n\t\t\tif (mask) {\n\t\t\t\ttr = tr || state.tr\n\t\t\t\ttr = maskText(tr.doc.resolve(posMark), '', mask, tr, false) || tr\n\t\t\t\tconst $newPos = tr.doc.resolve(posMark)\n\t\t\t\tconst newNode = $newPos.node($newPos.depth)\n\t\t\t\tif (newNode) {\n\t\t\t\t\tposMark += newNode.content.size + 1\n\t\t\t\t} else posMark++\n\t\t\t} else {\n\t\t\t\tposMark++\n\t\t\t}\n\t\t}\n\t\treturn tr\n\t}\n\n\treturn new Plugin({\n\t\tview: (v: EditorView) => {\n\t\t\tconst tr = applyDocMasks(v.state)\n\t\t\tif (tr) v.updateState(v.state.apply(tr))\n\t\t\treturn {}\n\t\t},\n\t\tprops: {\n\t\t\tdecorations(state) {\n\t\t\t\tlet $pos = state.doc.resolve(Math.min(state.selection.$from.pos, state.doc.content.size))\n\t\t\t\tlet node = $pos.parent\n\t\t\t\tlet start = $pos.pos - $pos.parentOffset\n\n\t\t\t\tif (node.type.spec.mask) {\n\t\t\t\t\tif (node.type.spec.mask.length === $pos.parentOffset && node.type.spec.mask.length === node.content.size) {\n\t\t\t\t\t\t//Move to the next one\n\t\t\t\t\t\twhile ($pos.pos < state.doc.content.size - 1) {\n\t\t\t\t\t\t\t$pos = state.doc.resolve($pos.pos + 1)\n\t\t\t\t\t\t\tnode = $pos.parent\n\n\t\t\t\t\t\t\tif (node && node.type.spec.mask) {\n\t\t\t\t\t\t\t\tstart = $pos.pos - $pos.parentOffset\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn DecorationSet.create(state.doc, [Decoration.node(start - 1, start - 1 + node.nodeSize, { class: 'focused' })])\n\t\t\t\t}\n\t\t\t\treturn undefined\n\t\t\t},\n\t\t\thandleTextInput: (view, from, to, text) => {\n\t\t\t\tif (view.composing) return false\n\n\t\t\t\tconst state = view.state\n\t\t\t\tconst $from = state.doc.resolve(from)\n\t\t\t\tconst mask = $from.parent.type.spec.mask\n\t\t\t\tconst regexp = $from.parent.type.spec.regexp\n\n\t\t\t\tif (!mask) return false\n\n\t\t\t\tconst tr = maskText(\n\t\t\t\t\t$from,\n\t\t\t\t\tregexp && regexp.length\n\t\t\t\t\t\t? text\n\t\t\t\t\t\t\t\t.split('')\n\t\t\t\t\t\t\t\t.filter((x) => x.match(new RegExp(regexp)))\n\t\t\t\t\t\t\t\t.join('')\n\t\t\t\t\t\t: text,\n\t\t\t\t\tmask,\n\t\t\t\t\tstate.tr,\n\t\t\t\t)\n\t\t\t\tif (tr) {\n\t\t\t\t\tconst tail: string = tr.getMeta('tailText')\n\t\t\t\t\tif (tail?.length) {\n\t\t\t\t\t\tconst nextPos = tr.selection.$to.pos < tr.doc.content.size ? tr.doc.resolve(tr.selection.$to.pos + 1) : undefined\n\t\t\t\t\t\tif (nextPos) {\n\t\t\t\t\t\t\tconst nextNode = nextPos.node(nextPos.depth)\n\t\t\t\t\t\t\tif (nextNode && nextNode.type.spec.mask && nextNode.type.spec.mask.length) {\n\t\t\t\t\t\t\t\tmaskText(nextPos, tail, nextNode.type.spec.mask, tr)\n\t\t\t\t\t\t\t} else if (nextNode && (nextNode.type.isText || nextNode.type.isTextblock)) {\n\t\t\t\t\t\t\t\ttr.insertText(tail, nextPos.pos, nextPos.pos)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tview.dispatch(tr)\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false\n\t\t\t},\n\t\t},\n\t\tappendTransaction: (transactions: readonly Transaction[], oldState: EditorState, newState: EditorState) => {\n\t\t\treturn applyDocMasks(newState)\n\t\t},\n\t})\n}\n"]}