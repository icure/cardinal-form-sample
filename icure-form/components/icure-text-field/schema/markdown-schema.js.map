{"version":3,"file":"markdown-schema.js","sourceRoot":"","sources":["../../../../tmp/components/icure-text-field/schema/markdown-schema.ts"],"names":[],"mappings":";;;AACA,mCAAkD;AAClD,iDAAyC;AAMzC,SAAgB,eAAe,CAC9B,IAAmC,EACnC,eAAoE,EACpE,aAAsE;IAEtE,MAAM,aAAa,GAA6C,CAAC,GAAW,EAAE,IAAc,EAAE,EAAE;QAC/F,gDAAgD;QAChD,OAAO,GAAG,KAAK,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,KAAK,OAAO,IAAI,CAAC,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,IAAI,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAA;IACpK,CAAC,CAAA;IACD,MAAM,aAAa,GAA6C,CAAC,GAAW,EAAE,EAAE;QAC/E,gDAAgD;QAChD,OAAO,GAAG,KAAK,MAAM,IAAI,CAAC,eAAe,EAAE,aAAa,EAAE,wBAAwB,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC;YACjG,CAAC,CAAC,IAAI;YACN,CAAC,CAAC,GAAG,KAAK,MAAM,IAAI,CAAC,eAAe,EAAE,iBAAiB,EAAE,wBAAwB,CAAC;gBAClF,CAAC,CAAC,IAAI;gBACN,CAAC,CAAC,KAAK,CAAA;IACT,CAAC,CAAA;IAED,OAAO;QACN,OAAO,EAAE,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,WAAW;QACvD,KAAK,EAAE,IAAA,mBAAW,EACjB;YACC,GAAG,EAAE;gBACJ,OAAO,EAAE,QAAQ;aACjB;YAED,SAAS,EAAE;gBACV,OAAO,EAAE,SAAS;gBAClB,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;gBACxB,KAAK;oBACJ,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC,CAAA;gBAChB,CAAC;aACD;YAED,UAAU,EAAE;gBACX,OAAO,EAAE,QAAQ;gBACjB,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,YAAY,EAAE,CAAC;gBACjC,KAAK;oBACJ,OAAO,CAAC,YAAY,EAAE,CAAC,CAAC,CAAA;gBACzB,CAAC;aACD;YAED,eAAe,EAAE;gBAChB,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;gBACzB,KAAK;oBACJ,OAAO,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,CAAC,CAAA;gBACvB,CAAC;aACD;YAED,OAAO,EAAE;gBACR,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,EAAE;gBAChC,OAAO,EAAE,iBAAiB;gBAC1B,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,IAAI;gBACd,QAAQ,EAAE;oBACT,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;oBAClC,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;oBAClC,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;oBAClC,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;oBAClC,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;oBAClC,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE;iBAClC;gBACD,KAAK,CAAC,IAAI;oBACT,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC,CAAA;gBACnC,CAAC;aACD;YAED,YAAY,EAAE;gBACb,OAAO,EAAE,YAAY;gBACrB,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE;gBAC3D,QAAQ,EAAE;oBACT;wBACC,GAAG,EAAE,IAAI;wBACT,QAAQ,CAAC,GAAG;4BACX,MAAM,EAAE,GAAG,GAAc,CAAA;4BACzB,OAAO;gCACN,KAAK,EAAE,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gCACtE,KAAK,EAAE,EAAE,CAAC,YAAY,CAAC,YAAY,CAAC;6BACpC,CAAA;wBACF,CAAC;qBACD;iBACD;gBACD,KAAK,CAAC,IAAI;oBACT,OAAO;wBACN,IAAI;wBACJ;4BACC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK;4BACvD,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI;yBAC9C;wBACD,CAAC;qBACD,CAAA;gBACF,CAAC;aACD;YAED,WAAW,EAAE;gBACZ,OAAO,EAAE,YAAY;gBACrB,KAAK,EAAE,OAAO;gBACd,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,EAAE;gBACpC,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,EAAE,KAAK,EAAG,GAAe,CAAC,YAAY,CAAC,YAAY,CAAC,EAAE,CAAC,EAAE,CAAC;gBACtG,KAAK,CAAC,IAAI;oBACT,OAAO,CAAC,IAAI,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAA;gBACrE,CAAC;aACD;YAED,SAAS,EAAE;gBACV,OAAO,EAAE,kBAAkB;gBAC3B,QAAQ,EAAE,IAAI;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;gBACzB,KAAK;oBACJ,OAAO,CAAC,IAAI,EAAE,CAAC,CAAC,CAAA;gBACjB,CAAC;aACD;YAED,IAAI,EAAE;gBACL,KAAK,EAAE,QAAQ;aACf;YAED,KAAK,EAAE;gBACN,MAAM,EAAE,IAAI;gBACZ,KAAK,EAAE;oBACN,GAAG,EAAE,EAAE;oBACP,GAAG,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;oBACtB,KAAK,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;iBACxB;gBACD,KAAK,EAAE,QAAQ;gBACf,SAAS,EAAE,IAAI;gBACf,QAAQ,EAAE;oBACT;wBACC,GAAG,EAAE,UAAU;wBACf,QAAQ,CAAC,GAAG;4BACX,MAAM,EAAE,GAAG,GAAc,CAAA;4BACzB,OAAO;gCACN,GAAG,EAAE,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC;gCAC3B,KAAK,EAAE,EAAE,CAAC,YAAY,CAAC,OAAO,CAAC;gCAC/B,GAAG,EAAE,EAAE,CAAC,YAAY,CAAC,KAAK,CAAC;6BAC3B,CAAA;wBACF,CAAC;qBACD;iBACD;gBACD,KAAK,CAAC,IAAI;oBACT,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAA;gBAC3B,CAAC;aACD;YAED,OAAO,EAAE;gBACR,OAAO,EAAE,cAAc;gBACvB,KAAK,EAAE,OAAO;aACd;YAED,OAAO,EAAE;gBACR,OAAO,EAAE,SAAS;gBAClB,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC;gBAC3B,KAAK;oBACJ,OAAO,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC,CAAA;gBACzC,CAAC;gBACD,MAAM,EAAE,UAAU;aAClB;YAED,IAAI,EAAE;gBACL,OAAO,EAAE,SAAS;gBAClB,KAAK,EAAE,OAAO;gBACd,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC;gBAC3B,KAAK;oBACJ,OAAO,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,CAAA;gBACtC,CAAC;aACD;YAED,SAAS,EAAE;gBACV,MAAM,EAAE,IAAI;gBACZ,KAAK,EAAE,QAAQ;gBACf,UAAU,EAAE,KAAK;gBACjB,QAAQ,EAAE,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;gBACzB,KAAK;oBACJ,OAAO,CAAC,IAAI,CAAC,CAAA;gBACd,CAAC;aACD;SACD,EACD,aAAa,CACb;QACD,KAAK,EAAE,IAAA,mBAAW,EAAC,IAAA,uBAAQ,EAAC,eAAe,EAAE,aAAa,CAAC,EAAE,aAAa,CAAC;KAC3E,CAAA;AACF,CAAC;AA1LD,0CA0LC","sourcesContent":["import { MarkSpec, NodeSpec, SchemaSpec } from 'prosemirror-model'\nimport { reduceMarks, reduceNodes } from './utils'\nimport { getMarks } from './common-marks'\n\nexport type DocumentSchema = 'text-document'\nexport type InlineSchema = 'styled-text' | 'text' | 'text-with-codes' | 'styled-text-with-codes'\nexport type StyledSchema = 'text-document' | 'styled-text' | 'styled-text-with-codes'\n\nexport function getMarkdownSpec(\n\ttype: DocumentSchema | InlineSchema,\n\tcontentProvider: (codes: { type: string; code: string }[]) => string,\n\tcolorProvider: (type: string, code: string, isCode: boolean) => string,\n): SchemaSpec {\n\tconst nodesSelector: (key: string, spec: NodeSpec) => boolean = (key: string, spec: NodeSpec) => {\n\t\t// noinspection RedundantConditionalExpressionJS\n\t\treturn key === 'paragraph' ? true : (spec.group === 'block' || ['doc', 'list_item', 'hardbreak', 'image'].includes(key)) && type !== 'text-document' ? false : true\n\t}\n\tconst marksSelector: (key: string, spec: MarkSpec) => boolean = (key: string) => {\n\t\t// noinspection RedundantConditionalExpressionJS\n\t\treturn key !== 'link' && ['text-document', 'styled-text', 'styled-text-with-codes'].includes(type)\n\t\t\t? true\n\t\t\t: key === 'link' && ['text-document', 'text-with-codes', 'styled-text-with-codes']\n\t\t\t? true\n\t\t\t: false\n\t}\n\n\treturn {\n\t\ttopNode: type === 'text-document' ? 'doc' : 'paragraph',\n\t\tnodes: reduceNodes(\n\t\t\t{\n\t\t\t\tdoc: {\n\t\t\t\t\tcontent: 'block+',\n\t\t\t\t},\n\n\t\t\t\tparagraph: {\n\t\t\t\t\tcontent: 'inline*',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tparseDOM: [{ tag: 'p' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['p', 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tblockquote: {\n\t\t\t\t\tcontent: 'block+',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tparseDOM: [{ tag: 'blockquote' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['blockquote', 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\thorizontal_rule: {\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tparseDOM: [{ tag: 'hr' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['div', ['hr']]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\theading: {\n\t\t\t\t\tattrs: { level: { default: 1 } },\n\t\t\t\t\tcontent: '(text | image)*',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tdefining: true,\n\t\t\t\t\tparseDOM: [\n\t\t\t\t\t\t{ tag: 'h1', attrs: { level: 1 } },\n\t\t\t\t\t\t{ tag: 'h2', attrs: { level: 2 } },\n\t\t\t\t\t\t{ tag: 'h3', attrs: { level: 3 } },\n\t\t\t\t\t\t{ tag: 'h4', attrs: { level: 4 } },\n\t\t\t\t\t\t{ tag: 'h5', attrs: { level: 5 } },\n\t\t\t\t\t\t{ tag: 'h6', attrs: { level: 6 } },\n\t\t\t\t\t],\n\t\t\t\t\ttoDOM(node) {\n\t\t\t\t\t\treturn ['h' + node.attrs.level, 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tordered_list: {\n\t\t\t\t\tcontent: 'list_item+',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tattrs: { order: { default: 1 }, tight: { default: false } },\n\t\t\t\t\tparseDOM: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttag: 'ol',\n\t\t\t\t\t\t\tgetAttrs(dom) {\n\t\t\t\t\t\t\t\tconst el = dom as Element\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\torder: el.hasAttribute('start') ? +(el.getAttribute('start') || 0) : 1,\n\t\t\t\t\t\t\t\t\ttight: el.hasAttribute('data-tight'),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\ttoDOM(node) {\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t'ol',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstart: node.attrs.order === 1 ? null : node.attrs.order,\n\t\t\t\t\t\t\t\t'data-tight': node.attrs.tight ? 'true' : null,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tbullet_list: {\n\t\t\t\t\tcontent: 'list_item+',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tattrs: { tight: { default: false } },\n\t\t\t\t\tparseDOM: [{ tag: 'ul', getAttrs: (dom) => ({ tight: (dom as Element).hasAttribute('data-tight') }) }],\n\t\t\t\t\ttoDOM(node) {\n\t\t\t\t\t\treturn ['ul', { 'data-tight': node.attrs.tight ? 'true' : null }, 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tlist_item: {\n\t\t\t\t\tcontent: 'paragraph block*',\n\t\t\t\t\tdefining: true,\n\t\t\t\t\tparseDOM: [{ tag: 'li' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['li', 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\ttext: {\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t},\n\n\t\t\t\timage: {\n\t\t\t\t\tinline: true,\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tsrc: {},\n\t\t\t\t\t\talt: { default: null },\n\t\t\t\t\t\ttitle: { default: null },\n\t\t\t\t\t},\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\tparseDOM: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttag: 'img[src]',\n\t\t\t\t\t\t\tgetAttrs(dom) {\n\t\t\t\t\t\t\t\tconst el = dom as Element\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tsrc: el.getAttribute('src'),\n\t\t\t\t\t\t\t\t\ttitle: el.getAttribute('title'),\n\t\t\t\t\t\t\t\t\talt: el.getAttribute('alt'),\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\ttoDOM(node) {\n\t\t\t\t\t\treturn ['img', node.attrs]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tmeasure: {\n\t\t\t\t\tcontent: 'decimal unit',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t},\n\n\t\t\t\tdecimal: {\n\t\t\t\t\tcontent: 'inline*',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tparseDOM: [{ tag: 'span' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['span', { class: 'measure' }, 0]\n\t\t\t\t\t},\n\t\t\t\t\tregexp: '[,.0-9-]',\n\t\t\t\t},\n\n\t\t\t\tunit: {\n\t\t\t\t\tcontent: 'inline*',\n\t\t\t\t\tgroup: 'block',\n\t\t\t\t\tparseDOM: [{ tag: 'span' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['span', { class: 'unit' }, 0]\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\thardbreak: {\n\t\t\t\t\tinline: true,\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\tselectable: false,\n\t\t\t\t\tparseDOM: [{ tag: 'br' }],\n\t\t\t\t\ttoDOM() {\n\t\t\t\t\t\treturn ['br']\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tnodesSelector,\n\t\t),\n\t\tmarks: reduceMarks(getMarks(contentProvider, colorProvider), marksSelector),\n\t}\n}\n"]}